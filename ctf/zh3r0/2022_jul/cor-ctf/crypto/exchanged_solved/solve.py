'''     ...: b = 5795014987100615243467302014637519655589220562695967625172441001618
    ...: 49358257125081211233093602227775598270939654689652681477200276478424926
    ...: 55071706063669328135127202250040935414836416360350924218462798003878266
    ...: 56320589326763517685167788927507662258211673506439709981127509431185531
    ...: 0291134721254402338711815917
    ...: s = 3570158135111160465491334886700707833940269177041036813362503042720
    ...: 27910577668531035109740895924113440657699573708026173784951618374426701
    ...: 57827768677411871042401500071366317439681461271483880858007469502453361
    ...: 70600197344190269861256488889273898683932202893593256586649228593023923
    ...: 1621460094395437739108335763
    ...: A = 2705569950255528261367920540242672730435988633782267523285646370856
    ...: 05987726660046636600525283286922820771655902594950903882166292400533970
    ...: 41429587052611133163886938471164829537589711598253115270161090086180001
    ...: 50122716492519927206430977770151469353568024709723311060230848600908341
    ...: 2543129797852747444605837628
    ...: B = 1321783200371127370097264683674718982421959235681582348717736070054
    ...: 24001152694338993978703689030147215843125095282272730052868843423659165
    ...: 01947547678878542651362787757419833437681820517378510236213715922528164
    ...: 03014426380675494147758208440399384331185867934585014678114059677739625
    ...: 68614238426424346683176754273



 

In [12]: 

In [12]: p
Out[12]: 142031099029600410074857132245225995042133907174773113428619183542435280521982827908693709967174895346639746117298434598064909317599742674575275028013832939859778024440938714958561951083471842387497181706195805000375824824688304388119038321175358608957437054475286727321806430701729130544065757189542110211847

In [13]: isPrime(p)
Out[13]: 1

In [14]: bdash = ( b * inverse(a-1,p) )%p

In [15]: a_bpriv = (( B + bdash) * inverse(s + bdash )) % p
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-15-2d796b9cc23f> in <module>
----> 1 a_bpriv = (( B + bdash) * inverse(s + bdash )) % p

TypeError: inverse() missing 1 required positional argument: 'v'

In [16]: a_bpriv = (( B + bdash) * inverse(s + bdash ,p)) % p

In [17]: a_bpriv
Out[17]: 29063376931172371845287877942976546880866929884320337167256459418671069174406604047580864378202023374962552151810961809116550565333153326548921316600450968620011009959635511041373577278160790705707556755722529730076215544604366790071634105119885320904079148327047425343620052566118072391261841024238109807687

In [18]: a
Out[18]: 118090659823726532118457015460393501353551257181901234830868805299366725758012165845638977878322282762929021570278435511082796994178870962500440332899721398426189888618654464380851733007647761349698218193871563040337609238025971961729401986114391957513108804134147523112841191971447906617102015540889276702905

In [19]: p
Out[19]: 142031099029600410074857132245225995042133907174773113428619183542435280521982827908693709967174895346639746117298434598064909317599742674575275028013832939859778024440938714958561951083471842387497181706195805000375824824688304388119038321175358608957437054475286727321806430701729130544065757189542110211847

In [20]: shared = 86382471144674987516192390676739968790606018844855369676663312
    ...: 31989742426458951905686058236643395466192368961345595099695707370873058
    ...: 65035672404614270680736009467314160684820763401262946424833942388388017
    ...: 98961052802865121895198819944744990914204503217602305639165324158861726
    ...: 404756338767093146109002421799336
    ...: 

In [21]: from hashlib import sha256

In [22]: key = sha256(long_to_bytes(shared)).digest()[:16]

In [23]: key
Out[23]: b'\xbdv\xdc\x8c\xe1\xd7X>!6\x91Tt\xfc\x19\xd2'

In [24]: ct = 'e0364f9f55fc27fc46f3ab1dc9db48fa482eae28750eaba12f4f76091b099b01f
    ...: db64212f66caa6f366934c3b9929bad37997b3f9d071ce3c74d3e36acb26d6efc9caa25
    ...: 08ed023828583a236400d64e'

In [25]: ct = bytes.fromhex(ct)

In [26]: ct
Out[26]: b"\xe06O\x9fU\xfc'\xfcF\xf3\xab\x1d\xc9\xdbH\xfaH.\xae(u\x0e\xab\xa1/Ov\t\x1b\t\x9b\x01\xfd\xb6B\x12\xf6l\xaao6i4\xc3\xb9\x92\x9b\xad7\x99{?\x9d\x07\x1c\xe3\xc7M>6\xac\xb2mn\xfc\x9c\xaa%\x08\xed\x028(X:#d\x00\xd6N"

In [27]: iv = ct[:16]

In [28]: iv
Out[28]: b"\xe06O\x9fU\xfc'\xfcF\xf3\xab\x1d\xc9\xdbH\xfa"

In [29]: ct = ct[16:]

In [30]: ct
Out[30]: b'H.\xae(u\x0e\xab\xa1/Ov\t\x1b\t\x9b\x01\xfd\xb6B\x12\xf6l\xaao6i4\xc3\xb9\x92\x9b\xad7\x99{?\x9d\x07\x1c\xe3\xc7M>6\xac\xb2mn\xfc\x9c\xaa%\x08\xed\x028(X:#d\x00\xd6N'

In [31]: from Crypto.Cipher import AES
    ...: from Crypto.Util.Padding import pad


In [32]: 

In [32]: cipher = AES.new(key, AES.MODE_CBC, iv=iv)

In [33]: cipher.decrypt(ct)
Out[33]: b'corctf{th1s_lcg_3xch4ng3_1s_4_l1ttl3_1ns3cur3_f0r_n0w}\n\n\n\n\n\n\n\n\n\n'
'''


#sage code

''' sage: a_bpriv = 2906337693117237184528787794297654688086692988432033716725645941
....: 86710691744066040475808643782020233749625521518109618091165505653331533265
....: 48921316600450968620011009959635511041373577278160790705707556755722529730
....: 07621554460436679007163410511988532090407914832704742534362005256611807239
....: 1261841024238109807687                                                    
sage: discrete_log(Mod(a_bpriv,p) , Mod(a,p))                                   
72294308363142635191285137067271613704518381689222403756427895774621470359587678998089163134800904011887080683864659561441585487866597353332892511005327144670737921076740544522591181991307617152388962472418690715521378068114703790176987564145359661515790454979281591952064634314009219343525018858317272168846
sage: b_priv = 72294308363142635191285137067271613704518381689222403756427895774
....: 62147035958767899808916313480090401188708068386465956144158548786659735333
....: 28925110053271446707379210767405445225911819913076171523889624724186907155
....: 21378068114703790176987564145359661515790454979281591952064634314009219343
....: 525018858317272168846                                                     
sage: A                                                                         
27055699502555282613679205402426727304359886337822675232856463708560598772666004663660052528328692282077165590259495090388216629240053397041429587052611133163886938471164829537589711598253115270161090086180001501227164925199272064309777701514693535680247097233110602308486009083412543129797852747444605837628
sage: shared = (( a^b_priv * A) % p + (( a^b_priv  - 1) * bdash)%p)%p '''

