from pwn import *

host = 'BBB.seccon.games'
port = 8080

r = remote(host, port)
print(r.recvline())

a = int(r.recvline().decode().strip().split('=')[-1])
print("a is ",a)

assert a%2 == 0

p = int(r.recvline().decode().strip().split('=')[-1])
print("p is ",p)

print(r.recvuntil(b': '))
b = (-121 - (a-1) * 11)%p

r.sendline(str(b).encode())

print(r.recvuntil(b': '))
s0 = 11
r.sendline(str(s0).encode())

print(r.recvuntil(b': '))
s1 = (-11 - a)%p
r.sendline(str(s1).encode())

assert pow(s1,(p-1)//2,p) == 1

lest = Mod(int((s1 + (a//2)^2 - b)%p),p).sqrt(all = True)
assert len(lest) == 2

s2 = int((lest[0] - (a//2))%p)
s3 = int((lest[1] - (a//2))%p)

print(r.recvuntil(b': '))
r.sendline(str(s2).encode())

print(r.recvuntil(b': '))
r.sendline(str(s3).encode())

if pow(s2,(p-1)//2,p) == 1:
	lest2 = Mod(int((s2 + (a//2)^2 - b)%p),p).sqrt(all = True)
elif pow(s3,(p-1)//2,p) == 1:
	lest2 = Mod(int((s3 + (a//2)^2 - b)%p),p).sqrt(all = True)
else:
	print("No solutions found for s4")
	exit()

s4 = int((lest2[0] - (a//2))%p)

print(r.recvuntil(b': '))
r.sendline(str(s4).encode())

print(r.clean(2).decode())
# r.interactive()

'''
[+] Public Key:
n=18229151937006897174803347447533469960550310691954785758253136495909672423881571569711787484697605181317544264196456216516545681050561635887356454500798529022197086116637516609738329214916076358052313862107443559545793118261026728692757504283936610043241724234553485132251293019194783942062693225341151667637064406199259396263329462767946235631063893420530000847067943982611228777621176613475618573670865191801824899687707799300680485823192572036848220566706554621918919829551258837868560363054682220987957456415497917883845120610223421974193769714974075665434608359994100416644354743445321368537864422382975467889239
e=11
[+] Cipher Text: 994187919545404103106877638833287614301468371674540410941588144511975437907904607582042839632793328959421672535621637279082792197683775809691007430921491571558892865036420333432924515918798329592456668949237682892310879367448443729453955178530442086477349340327486995732179399545699009302776745464904658711987397858634481917156449066969591689371453638206071597458404368946175762550295231137081151411744675467022774371454074611259756342208647199571547090491385284069463154712437170591032317484683879241349394954898334960364882540036957468061800025238178755881958305604968818902309548699178979726632161362585116326809
[+] Public Key:
n=19493125289119078099457729503296000545377757577857667483343875874930424927877353443932409690962429597633716283203776336759653481282587803561124086374076347861270877647500043049765505348227799029620946253987798746141053046109812498202999284595281642824926472044756058144245969478453103105094498522002991673766700102484148151539164946071272137545983706657066171664648164776484871265723226641662168450621763070418225151164617985270783915428675101787780408389559564145501918390306424509812888503298173433455833190989987156899135618158280184960861680333148533640861602114023789013413993783636917607435507777075887143222189
e=11
[+] Cipher Text: 5879922739113701968472010505540059418249080676720745283980468655574427657985484584312487350237042700376713157540912639438100029164641863046450106641604954291098471578477541496477676884457778559201182164579678034730092819838057560255530810630210566435244244085374183648325264874636321945416660340024714226212222058642142669187473380958801377753420164187951761869801246099374692340647766409957404761821362847643655027515268475511326436059300613439097782354608674253465252815771236192204748043886868519755239908840581835610861465726489700450079531713158630777883571046017140405980050904379946329935561161429751503237495
[+] Public Key:
n=24399575478748136517155969411709886203049118766215822027839254611895959925168612693494338466094326485574983159782039086377006283722572562722862562231695680511443570476610577942379370772680912073485717461092810318229021107855494372748976756621304565515300762442820824560326627499070452733966215180043825385866935956247217326418335432258932603928124828457725942262674465775816396130776206688530012022395526378535038313178703204246389378170112150810824574637730880863191185900125851359903236095998264388158057244695540079937392061856924194188610920991986934213034125722721606306413739389737156929961673086040500787305147
e=11
[+] Cipher Text: 884140737138587686465275268235401278713445265637348272295144147734634270525706310013046405355660046240627491150176120973788713777433770438735208765376589448414540504069261543089107138187205573799589352184808695439031657340281541433629303721016993024966560813022039360518027795660801847597733895207171458166756354854055511253734726665245101999913934774015835361910522759033833644143722895795841054773757644198679100580222068198277531145212678579557990693532879352088692155078070434308827128370654855058419844740526162044302129321547702739023629366689184309899370325608327107810089595966943240821299701062207512814145
[+] Public Key:
n=20218052670884057387155034017462624750721689456984229323201388985328327613329783879723538418847294332277816705785927837881510128863580690176469015634906410025586805169955104738245302342005358395894516273877405837528820952259507926079343383521102629233479078921199374038120362669740244474613690506339758977606323539066974678379709124826717886098035284669963945148755548945905624403287965488822659809614941855945902072079796012697200975755607380189942184187472139252644053080423961676688149011828608573428947470893719388388136314418997614738599272556879804677276002905121964986243303439477060357515532891073292608277199
e=11
[+] Cipher Text: 20101395463356243519590104310157941359309680735391320417511869640219184100735666474588159358860559053794627055915152215623552791334426983454965508477744325695708760271011986006825923744116845717433238017347428661874527133917874840024447765222164814316843821306315718622999508800704741715313061866152660982776372962122948891979749202705807972231925887276098992339759223037910313767562736342523766919711417981744915376884997643343059404191075263381126591304686420806915223480855469663205138117574426530347776719211164790013295326656913902555912958882179459134362206010332184407237189474248206342949463430775963540770173
[+] Public Key:
n=12448722944891542818980401071446890695884601939766954782733128166855349322375002964039326380470397010219888289058500014212890247535692909419333776078469232126148275796621143464601714356648131216112979064762193393686665821606970252225496175807074259544069575476758311806541572689250765926658356376525560560676344357716855141630316072472152382573674943219863973218814780307771528005327173577527949580805579013398916866549881174796076040011596594637829703310181451416402522518927948884925722539010780993735267189905829158058725314903834995315789453627329427342544134520006137711031489470169641333226276736214322764674359
e=11
[+] Cipher Text: 4050308525893785535578999405022795937446702997610442576352164291331446026986982892444041002938534658400467495099150203635343491937327682530863106180406256320990479046239648617509084037137022339869934499261091469785435584129316763713916718215463058732843696557464496789696987630475140789257456290002150858972800915228734111765398419803146505718091598261778829228931614131947884011189057669549422296116616890376710341634392751728894691650576229745564784253187874864138773583207264728877594191314546678701054601091043066317783171769594795460653278668535324546531213883546774461247144507989044517080151762362333757194357

'''

'''sage: n1 = 1822915193700689717480334744753346996055031069195478575825313
....: 649590967242388157156971178748469760518131754426419645621651654568
....: 105056163588735645450079852902219708611663751660973832921491607635
....: 805231386210744355954579311826102672869275750428393661004324172423
....: 455348513225129301919478394206269322534115166763706440619925939626
....: 332946276794623563106389342053000084706794398261122877762117661347
....: 561857367086519180182489968770779930068048582319257203684822056670
....: 655462191891982955125883786856036305468222098795745641549791788384
....: 512061022342197419376971497407566543460835999410041664435474344532
....: 1368537864422382975467889239                                      
sage: c1 = 9941879195454041031068776388332876143014683716745404109415881
....: 445119754379079046075820428396327933289594216725356216372790827921
....: 976837758096910074309214915715588928650364203334329245159187983295
....: 924566689492376828923108793674484437294539551785304420864773493403
....: 274869957321793995456990093027767454649046587119873978586344819171
....: 564490669695916893714536382060715974584043689461757625502952311370
....: 811514117446754670227743714540746112597563422086471995715470904913
....: 852840694631547124371705910323174846838792413493949548983349603648
....: 825400369574680618000252381787558819583056049688189023095486991789
....: 79726632161362585116326809                                        
sage: n2 = 1949312528911907809945772950329600054537775757785766748334387
....: 587493042492787735344393240969096242959763371628320377633675965348
....: 128258780356112408637407634786127087764750004304976550534822779902
....: 962094625398779874614105304610981249820299928459528164282492647204
....: 475605814424596947845310310509449852200299167376670010248414815153
....: 916494607127213754598370665706617166464816477648487126572322664166
....: 216845062176307041822515116461798527078391542867510178778040838955
....: 956414550191839030642450981288850329817343345583319098998715689913
....: 561815828018496086168033314853364086160211402378901341399378363691
....: 7607435507777075887143222189                                      
sage: c2 = 5879922739113701968472010505540059418249080676720745283980468
....: 655574427657985484584312487350237042700376713157540912639438100029
....: 164641863046450106641604954291098471578477541496477676884457778559
....: 201182164579678034730092819838057560255530810630210566435244244085
....: 374183648325264874636321945416660340024714226212222058642142669187
....: 473380958801377753420164187951761869801246099374692340647766409957
....: 404761821362847643655027515268475511326436059300613439097782354608
....: 674253465252815771236192204748043886868519755239908840581835610861
....: 465726489700450079531713158630777883571046017140405980050904379946
....: 329935561161429751503237495                                       
sage: n3 = 2439957547874813651715596941170988620304911876621582202783925
....: 461189595992516861269349433846609432648557498315978203908637700628
....: 372257256272286256223169568051144357047661057794237937077268091207
....: 348571746109281031822902110785549437274897675662130456551530076244
....: 282082456032662749907045273396621518004382538586693595624721732641
....: 833543225893260392812482845772594226267446577581639613077620668853
....: 001202239552637853503831317870320424638937817011215081082457463773
....: 088086319118590012585135990323609599826438815805724469554007993739
....: 206185692419418861092099198693421303412572272160630641373938973715
....: 6929961673086040500787305147                                      
sage: c3 = 8841407371385876864652752682354012787134452656373482722951441
....: 477346342705257063100130464053556600462406274911501761209737887137
....: 774337704387352087653765894484145405040692615430891071381872055737
....: 995893521848086954390316573402815414336293037210169930249665608130
....: 220393605180277956608018475977338952071714581667563548540555112537
....: 347266652451019999139347740158353619105227590338336441437228957958
....: 410547737576441986791005802220681982775311452126785795579906935328
....: 793520886921550780704343088271283706548550584198447405261620443021
....: 293215477027390236293666891843098993703256083271078100895959669432
....: 40821299701062207512814145                                        
sage: n4 = 2021805267088405738715503401746262475072168945698422932320138
....: 898532832761332978387972353841884729433227781670578592783788151012
....: 886358069017646901563490641002558680516995510473824530234200535839
....: 589451627387740583752882095225950792607934338352110262923347907892
....: 119937403812036266974024447461369050633975897760632353906697467837
....: 970912482671788609803528466996394514875554894590562440328796548882
....: 265980961494185594590207207979601269720097575560738018994218418747
....: 213925264405308042396167668814901182860857342894747089371938838813
....: 631441899761473859927255687980467727600290512196498624330343947706
....: 0357515532891073292608277199                                      
sage: c4 = 2010139546335624351959010431015794135930968073539132041751186
....: 964021918410073566647458815935886055905379462705591515221562355279
....: 133442698345496550847774432569570876027101198600682592374411684571
....: 743323801734742866187452713391787484002444776522216481431684382130
....: 631571862299950880070474171531306186615266098277637296212294889197
....: 974920270580797223192588727609899233975922303791031376756273634252
....: 376691971141798174491537688499764334305940419107526338112659130468
....: 642080691522348085546966320513811757442653034777671921116479001329
....: 532665691390255591295888217945913436220601033218440723718947424820
....: 6342949463430775963540770173                                      
sage: n5 =12448722944891542818980401071446890695884601939766954782733128
....: 166855349322375002964039326380470397010219888289058500014212890247
....: 535692909419333776078469232126148275796621143464601714356648131216
....: 112979064762193393686665821606970252225496175807074259544069575476
....: 758311806541572689250765926658356376525560560676344357716855141630
....: 316072472152382573674943219863973218814780307771528005327173577527
....: 949580805579013398916866549881174796076040011596594637829703310181
....: 451416402522518927948884925722539010780993735267189905829158058725
....: 314903834995315789453627329427342544134520006137711031489470169641
....: 333226276736214322764674359                                       
sage: c5 =40503085258937855355789994050227959374467029976104425763521642
....: 913314460269869828924440410029385346584004674950991502036353434919
....: 373276825308631061804062563209904790462396486175090840371370223398
....: 699344992610914697854355841293167637139167182154630587328436965574
....: 644967896969876304751407892574562900021508589728009152287341117653
....: 984198031465057180915982617788292289316141319478840111890576695494
....: 222961166168903767103416343927517288946916505762297455647842531878
....: 748641387735832072647288775941913145466787010546010910430663177831
....: 717695947954606532786685353245465312138835467744612471445079890445
....: 17080151762362333757194357                                        
sage: crt([c1,c2,c3,c4,c5],[n1,n2,n3,n4,n5])                            
114372786481052635910448498720091152000544384771914184977404873713486816967017212294564033729844151586559928283768508783123813234845257954353941294416761548835306490807144304027730492602098479650754259615449588128659661312156218245868273826898147062026954172633902888229646083634052739697101493383925776392894342863168484902686318801573272223536253586996951017168305461818675638054697458800861031657460789550985503741836443062855226617462603451840021728226385594398416497952029868034315581403325538957490306718744329836223036777006479541296805820834095893434928503682948755163831190710640942857082328331319339542949433352357093578344547752166958105375326243615086088145048399356494860641353376935454887894271519041776467150705097046382919240935179824929609163840185785516002611696695657206721809954099843900709783941175687750069843912866806589922074426894583183270628222320841485362915042530327256201089397001551056690840559335750516889925813938283361075777851873218949740788159228499378209791449010160424615112966820200203178938690405783346301517394188843536901988622674803212722021656154036966649069829246250807497738529800259890676612880155615024386432372020037944142135525718747085912432023193564308075923332787052028692503647235926402303791159204438455004249978192637418874695999143339230176867080797927193203714505079495436238633039293139466585750510051312057919089317537710177489670643910314332608698111137044966067126021687165909475419614411739383486450997042008837868673092146484108618360159866242169508222274188410199255707283671604454718481474930452358982002368403169765488857171176911158391236996950375985090489060226131237605604133359548896061056705305266893704743604173475425539225889679634776337863286082735858497553145164866719517636652118259999681987041406896123742734937438487964851125170525807616977943028604154252203675300227744696271296552134793722097436485355426680798324996895988816878106942964871697233659502309641056709434654786839424487396769575688493186344946874895051629258973926157664425735753025608930751863126057713550651871149305971213083087458176915887983974713916276033268676134251219672437463045811800372119445985937444981304499650328354407297402449490846200902916214466418784025229932920331606754041280114341968222275226361993294746040018110594134069565967666821145025708067762148644747819283440809183716188720822551139990991465027116872702250376345579309029921965939787737091316659601268194565504061095428369312923204826025381324753661479102123989321517439545907111748114250532998176158775442755580353104975648923525885453296939028166438675069257310388382148697704241543889416804239142596323928482854813827092061216560416052970605572691122835137766649193621093243263849073468152696405876774565473985123453478544652757952376709591017043506476867343796168390788881225003668257123047775858221238176629132179576925643121750288942962061845986764467803319876283051348886695908698492862109421134525636304534496860908864651382739337573398015373494181520778374058359392640695490822438943457280000000000000000000000
sage: from gmyp2 import iroot                                           
------------------------------------------------------------------------
ModuleNotFoundError                    Traceback (most recent call last)
<ipython-input-66-544cc1b5a2c6> in <module>
----> 1 from gmyp2 import iroot

ModuleNotFoundError: No module named 'gmyp2'
sage: from gmpy2 import iroot                                           
sage: flag = crt([c1,c2,c3,c4,c5],[n1,n2,n3,n4,n5])                     
sage: iroot(flag,11)                                                    
(mpz(2883019091813529219737035153484934929534955887753874746941092955853444099264575760415715710120591467702376578902084283075705374264225673611778863370445183048344031472894050836959651658562832755850169071594495017590365639338557184317630010713870560299144072307442885415899337200),
 True)
sage: iroot(flag,11)[0]                                                 
mpz(2883019091813529219737035153484934929534955887753874746941092955853444099264575760415715710120591467702376578902084283075705374264225673611778863370445183048344031472894050836959651658562832755850169071594495017590365639338557184317630010713870560299144072307442885415899337200)
sage: int(iroot(flag,11)[0])                                            
2883019091813529219737035153484934929534955887753874746941092955853444099264575760415715710120591467702376578902084283075705374264225673611778863370445183048344031472894050836959651658562832755850169071594495017590365639338557184317630010713870560299144072307442885415899337200
sage: long_to_bytes(int(iroot(flag,11)[0]))                             
b"SECCON{Can_you_find_d_in_bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbdbbbbbbbbbbbbbbbbbbbbbbbbbbbbb?}*\xfd*<'\xe5\xb2\xf3\xf3\xc0\xe8\xceT\xcd\x91\xf0"
sage:    
'''


# flag = SECCON{Can_you_find_d_in_bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbdbbbbbbbbbbbbbbbbbbbbbbbbbbbbb?}









